apiVersion: 1

contactPoints:
  - orgId: 1
    name: email-receiver
    receivers:
      - uid: email-receiver-uid
        type: email
        settings:
          addresses: andreassubs@icloud.com

policies:
  - orgId: 1
    receiver: email-receiver
    group_by: ['grafana_folder', 'alertname']

groups:
  - orgId: 1
    name: Infrastructure
    folder: Infrastructure
    interval: 1m
    rules:
      - uid: db_health_check
        title: Database Unresponsive
        condition: A
        data:
          - refId: A
            relativeTimeRange:
              from: 600
              to: 0
            datasourceUid: Postgres
            model:
              editorMode: code
              format: table
              rawQuery: true
              rawSql: SELECT 0
              refId: A
        noDataState: Alerting
        execErrState: Alerting
        for: 1m
        annotations:
          summary: "Database is unresponsive"
          description: "The Postgres database is not responding to queries."
        labels:
          severity: critical
